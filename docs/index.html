<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>LazyPredator</title>
    <style>
			body {
             background-color: white;
             font-family: Arial, Helvetica, sans-serif;
           }
      h1 { padding: 0; border: 0; margin: 0; margin-top: 0.2em; }
      h2 { padding: 0; border: 0; margin: 0; margin-top: 0.2em; }
      p { color: black; }
      code { font-size: 120%; }
      pre {
            color: black;
	          border: 1px dashed rgb(65%,65%,65%);
	          padding: 10px;
           	margin-bottom: 1em;
          }
      .comment { color: rgb(80%,80%,80%); }
      <!-- for in-page date anchors -->
      a.date         {color: black; }
			a.date:link    {text-decoration: none; color: black;}
			a.date:visited {text-decoration: none; color: black;}
			a.date:hover   {text-decoration: underline; color: black;}
			a.date:active  {text-decoration: none; color: black;}
      .post {
              border-top: 0.3em solid rgb(25%,25%,25%);
              margin-top: 1em;
              padding-left: 2em;
              padding-right: 2em;
              padding-top: 1em;
              clear: left ;
            }
      .designnote { color: rgb(25%,25%,25%) }
      .novak_pad { margin-right: 105px; margin-left: 105px; }
      .smaller { font-size: 75%; }
    <!-- --------------------------------------------------------------------------- -->
    <div class="post" id="yyyymmdd">
      <a href="#yyyymmdd" class="date">Month 0, 0000</a>
      <h1>Title</h1>
      <p>...</p>
      <pre>x</pre>
    </div>
    <!-- --------------------------------------------------------------------------- -->
    </style>
  </head>
  <body id="top">
    <p class="smaller"><a href="https://cwreynolds.github.io/LazyPredator/">This
        page on GitHub</a></p>
    <h1>LazyPredator</h1>
    <p><strong>LazyPredator</strong> is a library for <a href="https://en.wikipedia.org/wiki/Evolutionary_computation">evolutionary
        computation</a>, a type of population-based optimization algorithm. It
      uses <a href="https://en.wikipedia.org/wiki/Generic_programming">genetic
        programming</a> where the individuals of the population are computer
      programs in a “domain specific language”. The relative “fitness” or
      “quality” of these programs is measured in small “tournaments” where the
      programs compete against each other. Using a <a href="https://en.wikipedia.org/wiki/Negative_selection_%28natural_selection%29">negative
        selection</a> approach, the lower fitness individuals of a tournament
      are removed from the population, and replaced by a new “offspring” of the
      tournament's higher fitness individuals. (The offspring is created from
      parents by “cross-over” and “mutation” as described <a href="https://en.wikipedia.org/wiki/Genetic_programming">here</a>.)
      Negative selection implies that individuals below a certain fitness
      threshold die off—while those above generally survive, regardless of rank
      in the population. This is the opposite of “elitism” and related practices
      in evolutionary computation where the focus is on identifying and
      promoting the high fitness individuals. LazyPredator seeks to encourage
      “genetic drift”—while continuing to prune the low performing
      individuals—in order to gradually improve population fitness.</p>
    <p>The name “LazyPredator” refers to this type of negative selection in
      nature. A lioness may be capable of running down a healthy adult antelope.
      But given the opportunity, she would rather find easier prey (the young,
      or old, or injured) so she can obtain food for her family using less of
      her own energy. Through this action, most of the antelope herd will be
      fit, strong, and fast enough to survive. At the risk of mixing metaphors,
      or at least species, there is a very old joke about this:</p>
    <p style="margin-left: 40px;"> Annie and Bob are camping when they see a
      bear running toward them.<br>
      Annie starts putting on her tennis shoes.<br>
      Bob says, “What are you doing?! You can’t outrun a bear!”<br>
      Annie says, “I don’t have to outrun the bear—I just have to outrun you!”</p>
    <p>LazyPredator is a sibling of <a href="https://cwreynolds.github.io/TexSyn/">TexSyn</a>
      a library for procedural texture synthesis. Together they support
      experiments in adversarial evolutionary texture synthesis. I am especially
      interested in simulating the evolution of camouflage in nature, as in this
      earlier work: <a href="https://www.red3d.com/cwr/iec/">Interactive
        Evolution of Camouflage</a>.</p>
    <p>The code repository for LazyPredator is at <a href="https://github.com/cwreynolds/LazyPredator">GitHub</a>.</p>
    <p>(I'm wondering about the writing style of this notebook. The one for <a
        href="https://cwreynolds.github.io/TexSyn/">TexSyn</a> was largely
      intended to show texture images along with commentary. When possible, I
      tried to avoid coding detail. LazyPredator is about plain old software
      design, so probably there will be more discussion here of lower level
      details of the implementation. On the other hand, I do want it to be more
      prose-like than the terse <code>git commit</code> messages.)</p>
    <br style="##########################################################################">
    <div class="post" id="20200813"> <a href="#20200813" class="date">August
        13, 2020</a>
      <h1>Making random programs</h1>
      <p>I've been prototyping a <code>FunctionSet</code> class to represent
        the “domain specific language” manipulated by genetic programming.
        LazyPredator implements <em>strongly typed genetic programming</em>
        where the values of <em>function</em> and <em>terminals</em>, and the
        parameters to <em>functions</em>, all have associated <em>types</em>.
        I made a simple API for adding definitions of the <em>types</em> and
        the <em>functions</em> used in the “domain specific language”. These
        use prototype underpinnings, just enough scaffolding to begin developing
        additional functionality. After I “rough out” a working <code>FunctionSet</code>
        class, and so better understand the requirements, I will refactor the
        underlying <code>FunctionSet</code> structure to be more clean and
        efficient.</p>
      <p>To initialize a GP population we need a utility—here called <code>FunctionSet</code><code>::makeRandomProgram()</code>—to
        generate a “random program” in the “domain specific language” (aka a
        grammar) defined by a <code>FunctionSet</code> instance. By “random
        program” I mean a random <em>expression</em>, a composition of <em>functions</em>
        and <em>terminals</em> which, when evaluated, produce a value. <code>makeRandomProgram()</code>
        is further parameterized by a <code>max_size</code> for the generated
        programs. This size is measured as the count of function names and <em>
          terminals</em> such as numeric constants (and potentially input <em>variables</em>,
        but that is not currently supported).</p>
      <p>This post is to mark that my prototype <code>makeRandomProgram()</code>
        is now generating random programs that are no longer obviously wrong. I
        made a toy <code>FunctionSet</code> corresponding to a tiny subset of <a
          href="https://cwreynolds.github.io/TexSyn/">TexSyn</a>. The <em>functions</em>
        are drawn from: <code>Vec2</code>, <code>Uniform</code>, <code>Affine</code>,
        <code>Multiply</code>, and <code>Scale</code>. The <em>terminals</em>
        are <code>float</code> “ephemeral constants” whose values are randomly
        initialized. Here are a couple of “random programs” of size 20:</p>
      <pre>Scale(-1.89065,
      Affine(Vec2(2.71928, 1.51213),
             Vec2(-2.15447, 3.58087),
             Multiply(Scale(-0.46497,
                            Uniform(0.270371, 0.544808, 0.653164)),
                      Uniform(0.582032, 0.0811457, 0.593893))))

Affine(Vec2(1.62775, 0.925812),
       Vec2(0.892051, -2.5576),
       Scale(-3.9347,
             Affine(Vec2(1.14234, 0.321014),
                    Vec2(3.70146, 3.92498),
                    Uniform(0.842375, 0.46032, 0.180332))))</pre>
      <p>These are of course gibberish, not only because they are “random” but
        because this tiny function set is unable to express anything
        interesting. One important problem with the current code is that there
        is a bug in the control of program size. The <code>max_size</code>
        parameter is intended to be a strict upper bound. Instead <code>FunctionSet</code><code>::makeRandomProgram()</code>
        generates programs whose sizes are distributed “in the vicinity of” <code>max_size</code>.
        That is at least better than a recent version that generated programs up
        to size 1000.</p>
    </div>
    <div class="post" id="20200807"> <a href="#20200807" class="date">August 7,
        2020</a>
      <h1>Monitor lifetime of <code>Individual</code> in <code>Population</code></h1>
      <p>My vague plan is that the <code>Population</code> class will handle
        all aspects of <code>Individual</code>s. A <code>Population</code>
        instance will generate the initial collection of random programs. It
        will randomly select the individuals to participate in a tournament. It
        will form offspring from tournament winners, remove the losers, and
        replace them with the offspring. </p>
      <p>One important bit of “owning” the individuals is that they must be
        properly allocated and de-allocated. I gave the <code>Individual</code>
        class a counter which gets incremented in the constructor and
        decremented in the destructor. </p>
      <p>I made the first unit test which ensures that this count is initially
        zero, then constructing a <code>Population</code> with <em>n</em> <code>Individual</code>s
        causes it to be n, and that deleting the <code>Population</code> causes
        it to go back to zero. Right now it only tests the initial creation of
        (“mock”) <code>Individual</code>s, later the unit test should include
        running tournaments.</p>
    </div>
    <div class="post" id="20200806"> <a href="#20200806" class="date">August 6,
        2020</a>
      <h1>Getting started, stubs for <code>Population</code>, <code>Individual</code>,
        and <code>UnitTests</code></h1>
      <p>Just starting to rough out the components of the system. Today it is a
        class for an evolutionary <code>Population</code> and the <code>Individual</code>s
        in it. Also a namespace for <code>UnitTests</code> with a goal of using
        “test driven development.”</p>
    </div>
    <div class="post" id="0">
      <p>This page, and the software it describes, by <a href="https://www.red3d.com/cwr">Craig
          Reynolds</a></p>
    </div>
  </body>
</html>
